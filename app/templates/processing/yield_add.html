{# /home/thumbi/rizara/app/templates/processing/yield_add.html #}
{% extends "layouts/base.html" %}

{% block title %}Record Processing Yield | Rizara{% endblock %}

{% block body %}

<nav class="bg-jungle text-white px-6 py-4 flex justify-between items-center shadow">
  <div class="text-xl font-bold tracking-wide">Rizara Meats</div>
  <div class="flex items-center gap-3">
    <a href="{{ url_for('main.view_invoiceable_batch', batch_id=batch.id) }}"
       class="bg-gold text-jungle font-semibold px-4 py-2 rounded hover:bg-yellow-400 transition">
      ← Back to Batch
    </a>
    <a href="{{ url_for('auth.logout') }}"
       class="bg-white/10 text-white font-semibold px-4 py-2 rounded hover:bg-white/20 transition">
      Logout
    </a>
  </div>
</nav>

<main class="max-w-3xl mx-auto px-6 py-10">

  <div class="mb-8">
    <h1 class="text-3xl font-bold text-jungle">Record Processing Yield</h1>
    <p class="text-gray-600 mt-1">
      Batch #{{ batch.id }} • {{ batch.animal_type|capitalize }} • Facility: <b>{{ batch.facility }}</b>
    </p>
  </div>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="mb-6 space-y-3">
        {% for category, message in messages %}
          <div class="px-4 py-3 rounded-lg
            {% if category == 'success' %}
              bg-green-100 text-green-800
            {% elif category in ['danger', 'error'] %}
              bg-red-100 text-red-800
            {% else %}
              bg-gray-100 text-gray-800
            {% endif %}
          ">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <div class="bg-white rounded-xl shadow p-8">
    <form method="POST" class="space-y-6">

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-1">
          Total Carcass Weight (kg)
        </label>
        <input name="total_carcass_weight_kg" type="number" step="0.01" required
               class="w-full border border-gray-300 rounded-lg px-4 py-2
                      focus:outline-none focus:ring-2 focus:ring-jungle" />
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-1">
          Parts included in batch sale?
        </label>
        <select name="parts_included_in_batch_sale"
                class="w-full border border-gray-300 rounded-lg px-4 py-2
                       focus:outline-none focus:ring-2 focus:ring-jungle">
          <option value="yes">Yes</option>
          <option value="no">No</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-1">
          Any parts sold separately?
        </label>
        <select name="parts_sold_separately"
                class="w-full border border-gray-300 rounded-lg px-4 py-2
                       focus:outline-none focus:ring-2 focus:ring-jungle">
          <option value="no">No</option>
          <option value="yes">Yes</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-1">
          Parts Notes <span class="text-gray-400">(optional)</span>
        </label>
        <textarea name="parts_notes" rows="4"
                  class="w-full border border-gray-300 rounded-lg px-4 py-2
                         focus:outline-none focus:ring-2 focus:ring-jungle"></textarea>
      </div>

      <div class="flex justify-end gap-4 pt-2">
        <a href="{{ url_for('main.view_invoiceable_batch', batch_id=batch.id) }}"
           class="px-5 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition">
          Cancel
        </a>
        <button type="submit"
                class="px-6 py-2 rounded-lg bg-jungle text-white font-semibold hover:bg-jungleLight transition">
          Save Yield
        </button>
      </div>

    </form>
  </div>

</main>

<footer class="text-center text-sm text-gray-500 py-6">
  © {{ current_year or 2026 }} Rizara Meats Ltd — Secure • Traceable • Halal
</footer>

{% endblock %}
